## 论文翻译
### Introduction
引言

病毒是地球上最丰富的生物实体，存在于每一个生态系统中。理解病毒如何调节微生物群落动态和功能输出是一个涉及从全球生物地球化学到人类健康和疾病等多个层面的活跃研究领域。尽管病毒数量庞大且影响深远，但由于病毒的巨大遗传多样性，以及大多数基因组学工具依赖于与现有参考数据库的序列相似性，综合性大规模的病毒宏基因组学（viromics）研究受到了严重阻碍。这些问题还因病毒中缺乏普遍基因而加剧，使得在多样化的病毒群体中进行系统发育和比较分析变得复杂。总体而言，这些挑战阻碍了既准确又可扩展到日益多样化的病毒数据集的宏基因组学软件的开发。因此，迫切需要开发基于数据驱动的框架，使用可泛化的基因组学原则而非简单的序列同源性方法来研究病毒。

蛋白质语言模型（pLMs）是用于可泛化基因组学的有前途的深度学习框架。在数百万蛋白质的语料库上训练的pLMs已被证明能够像读句子中的单词一样模拟蛋白质序列中的氨基酸模式，利用蛋白质内的氨基酸的上下文信息捕捉蛋白质的生化、功能和结构特征。将pLMs应用于病毒数据集已显示出在蛋白质功能注释和宿主预测方面的增强能力。然而，这些研究仅关注了特定任务，没有考虑pLMs对各种宏基因组学任务普遍有益，从而错过了基础pLMs的真正潜力。pLMs本身的一个额外缺点是它们没有考虑进化驱动的基因组组织。最近的工作通过在短基因组片段上使pLM嵌入具有上下文性，甚至将整个基因组表示为pLM嵌入的聚合来解决这一问题。然而，这些模型每个只针对一种特定类型的表示：前者在增加了基因组上下文的情况下表示蛋白质，而后者将基因组表示为基于特定分类任务的蛋白质嵌入的加权和。因此，这些方法没有一种是真正可泛化到需要蛋白质和基因组水平推理的各种宏基因组学任务。

在这里，我们介绍我们的蛋白质集合变换器（PST），一种基于蛋白质的基因组语言模型，使用编码器-解码器范式同时产生基因组上下文化的蛋白质嵌入和基因组水平嵌入的单一端到端模型。我们在超过10万个高质量去重的病毒基因组上预训练了一个基础病毒PST（vPST）模型，这些基因组编码了超过600万蛋白质，并在一个独特的测试数据集上进行了评估，该数据集包含超过15万个高质量的病毒基因组，编码了超过700万蛋白质。我们证明vPST在基于共享蛋白质内容的病毒基因组-基因组关系方面表现更好。此外，我们观察到只有vPST能够一致地聚类操作相关蛋白质，如晚期基因蛋白，表明基因组上下文感知训练的重要性。此外，vPST蛋白质嵌入与蛋白质结构关系相关，通过聚类具有未注释功能的衣壳折叠蛋白与已注释衣壳蛋白得以证明。

值得注意的是，无论是基因组上下文化的vPST蛋白质嵌入还是基因组嵌入都未根据任何外部标签学习，这意味着它们将对广泛的应用程序有用。由于vPST的灵活性，我们建议vPST可以用于迁移学习来建模其他以病毒为中心的任务，如病毒基因和基因组识别、基因组质量控制、基因组装箱、分类和宿主预测，这些都是宏基因组学研究的主要组成部分。因此，我们预期vPST将是未来宏基因组学研究的基础。此外，我们认为，当在微生物基因组而非或除了病毒基因组上训练时，PST架构可以是微生物基因组学的通用模型。

### 结果

开发蛋白质集合变换器（PST）作为基因组语言模型  

![image](https://github.com/user-attachments/assets/4119dec1-65cf-443c-8153-b72389b68f43)  
图1. 蛋白质集合变换器（PST）的架构和训练体制。A）基于图的PST的总体概述，用于从上下文化的蛋白质嵌入中学习基因组表征。每个蛋白质由ESM2蛋白质嵌入表示。PST内部将每个基因组表示为一个图，由多个完全连接的局部相邻蛋白质的子图组成。每个子图的大小是一个调整的超参数。PST使用多头注意力来上下文化每个基因组内的蛋白质嵌入，并学习每个基因组的加权平均的每个蛋白质的权重。有关PST的建模中心视图，请参见扩展数据图1。蛋白质和基因组表征都可以用于适当的下游任务。B）包括数据增强技术C）PointSwap采样的三元组挖掘工作流。对于每个训练基因组，从定义为最小Chamfer距离的ESM2嵌入空间中识别出一个正基因组。然后，从PST嵌入空间中选择一个负基因组，该基因组是正基因组之后的下一个更远的基因组。我们通过在每个基因组及其正基因组之间交换相似的蛋白质向量来增强我们的训练数据。D）用于训练病毒PST（vPST）的三元组损失目标函数的图解表达。三元组损失的操作目标是使每个基因组及其正基因组在嵌入空间中比每个基因组及其负基因组更接近，距离边界可调。

PST（图1A，扩展数据图1）将基因组模型化为蛋白质集合，采用自然语言处理、集合和点集变换器领域的原则。因此，我们将PST称为基于蛋白质的基因组语言模型，因为它在基因组尺度上对蛋白质信息进行上下文化。在PST中，每个基因组的所有蛋白质都使用成熟的ESM2 pLM进行嵌入。与集合变换器不同，PST将小向量连接到pLM嵌入上，以模拟蛋白质基因组位置和编码链。每个基因组更新后的蛋白质嵌入被送入PST编码器，该编码器使用多头注意力来上下文化每个基因组内的蛋白质表征（简称为“PST蛋白质嵌入”）。这些PST蛋白质嵌入可用于蛋白质层面的任务，如蛋白质分类和功能注释。在端到端的PST中，PST蛋白质嵌入进一步传递给PST解码器，解码器也使用多头注意力来权衡基因组中每个蛋白质的相对重要性。这些权重用于加权平均上下文化的蛋白质，以产生基因组表征。

语言模型的常见训练目标之一是由类似的基于蛋白质的基因组语言模型使用的掩蔽语言建模，它涉及预测句子中掩蔽的标记（词）。在由表示为密集向量的蛋白质词组成的基因组句子的情况下，掩蔽语言建模的直观性较差，可能使训练过于复杂。我们选择镜像关系引导的基因组学，以更好地理解遗传多样性的模式，使用三元组损失函数（图1B, 1D）。在vPST基础模型的自我监督预训练期间，三元组损失使用vPST嵌入空间中的距离作为基因组-基因组相关性的衡量标准。在vPST中，基因组-基因组关系隐式地依赖于蛋白质-蛋白质的相关性。简而言之，三元组损失涉及形成基因组三元组，包括一个作为锚点，与锚点最相关的基因组作为正例，以及一个比正基因组不那么相似的基因组作为负例（图1B, 1D）。正例是在输入嵌入空间中的训练小批次内的基因组中使用Chamfer距离定义的，而负例则在vPST嵌入空间中采样。Chamfer距离计算为基因组对的蛋白质-蛋白质距离的平均最小值，意味着正基因组的蛋白质与锚点基因组最为相似。三元组损失的目标是将正基因组嵌入到比负基因组更接近锚点的位置，距离边界可调（图1D）。

为了帮助vPST学习更通用的表征，我们对每个基因组及其最相关的基因组使用数据增强技术PointSwap（图1C），这些基因组是根据上述Chamfer距离定义的（图1B）。每对基因组交换最相似的蛋白质向量，这类似于同源重组。然后我们更新三元组损失目标，包括最大化锚点基因组及其对应的通过PointSwap产生的增强混合基因组之间的相似性。  
![image](https://github.com/user-attachments/assets/34ac2c0c-226e-43af-8672-2a258bd1de82)  
图2. vPST学习了各种病毒集合的生物学意义深刻的基因组表征。A) 每种方法产生的基因组嵌入的UMAP降维图，按病毒领域进行颜色编码。“Kmer”代表4-mer核苷酸频率向量。“Ctx-avg”方法是每个基因组的vPST蛋白质嵌入的平均值。B-D) 通过在测试数据集的基因组嵌入的k-最近邻图上使用Leiden算法检测到的基因组聚类的统计数据：B) 聚集的基因组比例，C) 每个簇的平均基因组数量，D) 簇的总数。仅当一个簇至少有两个基因组时才计入统计。E) 上部：对簇内所有病毒对的氨基酸同一性（AAI）进行计算，并对整个簇进行平均。然后，根据每种方法，对每个簇的AAI进行加权平均，权重由簇的大小决定。下部：顶部行中的数据按照测试数据集中聚集的基因组比例进行缩放。所有分析均使用vPST测试数据集进行。  



